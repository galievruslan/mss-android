package com.mss.domain.services;

import java.util.Calendar;
import java.util.Date;
import java.util.Iterator;

import com.mss.domain.models.Order;
import com.mss.domain.models.Route;
import com.mss.domain.models.RoutePoint;
import com.mss.infrastructure.ormlite.DatabaseHelper;
import com.mss.infrastructure.ormlite.OrmliteOrderRepository;
import com.mss.infrastructure.ormlite.OrmliteRouteRepository;

public class OrderService {
	
	private DatabaseHelper databaseHelper;
	private OrmliteOrderRepository orderRepo;
	public OrderService(DatabaseHelper databaseHelper) throws Throwable{
		this.databaseHelper = databaseHelper;
		orderRepo = new OrmliteOrderRepository(this.databaseHelper);
	}
	
	public Order getById(long id) throws Throwable {
		return orderRepo.getById(id);
	}
	
	public Order getByRoutePoint(RoutePoint routePoint) throws Throwable{		
		Iterator<Order> iterator = orderRepo.findByRoutePointId(routePoint.getId()).iterator();
		if (iterator.hasNext())
			return iterator.next();
		
		return null;
	}
	
	public Route createOrder(RoutePoint routePoint) {
		Order order = new Order(routePoint);
		
		return order;
	}
	
	public void saveOrder(Order order) throws Throwable{
		orderRepo.save(order);
	}
}
